from arc4 import ARC4
from pwn import xor
encrypted = bytes.fromhex('fde5f5e12640b9860f526a9601861e752e84d866825c415549f454fe8ba3')
S = b'E^e\x95 \n\xff\x80\xe9]\x7fP\x92\x17\x01\xaf70\xe1\x9e,&?\x9b~\x0f\x10\x8a\xc9Y\xf6\xd3\xd7c\xdc\x86J\xa0)-T\xd1\x9dH\x8f\xfd\xba\xb4X\x0e\xd2\x82!\xc7f\xac9M\xbf\xa3\x13\xbdt\xa1\r|\xe0\x14\x0b(\x12N\xd56\xbba\x8c\xa9\xef\xa5p\x08%lI\xe6\xb0>\xdb\xe25nU\x962\xf2\x16G\xbc\x97y\xb6\x93m\xecAq\x04\x07\xd6\xa8\x15\xb8\x06\x89\xa2\t\xc3\xf9\x008z\x8b\xca\x8d[\xb1\xcc\xeeo\x11\xc8\xb7\x884\xb9\xf7\xf8\xebK\x9a;w\xa6\xc4S\x90\xe5\xd0`R\xb2\x1d\x94\xb3<\xa7\xad@\xfe\xc5\xfb\xc6\x1f\xd8\\x\xe4\xf4Q\xf3\xcd\xc1*\x193\x9f\x1bV1b\xe3+L:/\x99\xc2}_\x85\xde\x84D\xabC"\xaa\x1e\xbe\xaeh\x18\x9c\x98\x05\xf1\xed\xe7\x8e=#B\xd4\xb5d.\x87{\xdd\xea\xcf\xf5kr$\xc0sW\xe8\xda\xa4\xcb\x02u\x1a\xcejO\xdfiv\xd9\x81\'\x03\x0c\xfcg\x1cZF\x83\xfa\xf0\x91'

sus = b"n\x94h\xfb7\xb8\x9a\x85i\x9e\x99k\x90\xa6\xcex\xa1\x1a'O3\x8f*\xed\x97\xe5{\xb6\xd0\xdd$9"

key = b'hithisisakey'
c = ARC4(key)

def decrypt(S,plain,sus):
    i = 0
    j = 0
    k = 0
    S = list(S)
    
    while k <30:
        i = (i + 1) % 256
        j = (j +S[i]) % 256
        S[i],S[j] = S[j],S[i]
        # print(hex(S[(S[j] + S[i]) % 256]),end  =",")
        print(chr((-sus[k] + plain[k] + S[(S[j] + S[i]) % 256])&0xff),end ="")
        k+=1

print(chr((-sus[0]+ 0xfd + 0xc4)&0xff))

decrypt(S,encrypted,sus)
