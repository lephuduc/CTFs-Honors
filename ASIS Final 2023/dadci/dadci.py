from pwn import *
triangle = """
111111111111111111111011111111111111111111
111111111111111111110001111111111111111111
111111111111111111100110111111111111111111
111111111111111111001000011111111111111111
111111111111111110011011101111111111111111
111111111111111100100001000111111111111111
111111111111111001101111011011111111111111
111111111111110010000110000001111111111111
111111111111100110111000111110111111111111
111111111111001000010011011100011111111111
111111111110011011110100001001101111111111
111111111100100001100101111010000111111111
111111111001101110001100110010111011111111
111111110010000100110001000110010001111111
111111100110111101000111011000110110111111
111111001000011001011010000011000000011111
111110011011100011000010111100011111101111
111100100001001100011110011001101111000111
111001101111010001101100100010000110011011
110010000110010110000001101110111000100001
100110111000110000111110000100010011101110
""".replace('\n','')
triangle = b'11111111111111111111111111111111111110111111111111111111111111111111111111\n11111111111111111111111111111111111100011111111111111111111111111111111111\n11111111111111111111111111111111111001101111111111111111111111111111111111\n11111111111111111111111111111111110010000111111111111111111111111111111111\n11111111111111111111111111111111100110111011111111111111111111111111111111\n11111111111111111111111111111111001000010001111111111111111111111111111111\n11111111111111111111111111111110011011110110111111111111111111111111111111\n11111111111111111111111111111100100001100000011111111111111111111111111111\n11111111111111111111111111111001101110001111101111111111111111111111111111\n11111111111111111111111111110010000100110111000111111111111111111111111111\n11111111111111111111111111100110111101000010011011111111111111111111111111\n11111111111111111111111111001000011001011110100001111111111111111111111111\n11111111111111111111111110011011100011001100101110111111111111111111111111\n11111111111111111111111100100001001100010001100100011111111111111111111111\n11111111111111111111111001101111010001110110001101101111111111111111111111\n11111111111111111111110010000110010110100000110000000111111111111111111111\n11111111111111111111100110111000110000101111000111111011111111111111111111\n11111111111111111111001000010011000111100110011011110001111111111111111111\n11111111111111111110011011110100011011001000100001100110111111111111111111\n11111111111111111100100001100101100000011011101110001000011111111111111111\n11111111111111111001101110001100001111100001000100111011101111111111111111\n11111111111111110010000100110001110111001111011101010001000111111111111111\n11111111111111100110111101000110100010010110001001010111011011111111111111\n11111111111111001000011001011000101110110000111011010010000001111111111111\n11111111111110011011100011000011100100000111010000010110111110111111111111\n11111111111100100001001100011101001101111010010111110000011100011111111111\n11111111111001101111010001101001010000110010110011100111101001101111111111\n11111111110010000110010110001011010111000110000101001011001010000111111111\n11111111100110111000110000111000010010011000111101011000011010111011111111\n11111111001000010011000111010011110110100011011001000011100010010001111111\n11111110011011110100011010010101100000101100000011011101001110110110111111\n11111100100001100101100010110100001111100001111100001001010100000000011111\n11111001101110001100001110000101110111001110111001111011010101111111101111\n11110010000100110001110100111100100010010100010010110000010100111111000111\n11100110111101000110100101011001101110110101110110000111110101011110011011\n11001000011001011000101101000010000100000100100000111011100101001100100001\n10011011100011000011100001011110111101111101101111010001001101010001101110\n'.replace(b'\n',b'')
# print(len(triangle))
# for i in range(42):
#     print(get_bytes(u64(get_bytes(0x55BD674B2480+i*8,8)),42).decode())


with open('flag-ori.enc','rb') as f:
    enc = f.read()

bin_str = '00'
for i in range(1,len(enc)):
    bin_str += bin(enc[i])[2:].zfill(8)
print(len(bin_str))
bin_str = xor(bin_str,triangle)


# t ='00 00000000 00001111 00100011 11000000 00000000'
# t_='00111111 11110011 00000010 00110011 11111111 00'
# t2='0000000000000000 00001111 00100011 11000000 000'
N = 74
for i in range(38):
    print(bin_str[i*N:i*N+N].replace(b'\x01',b'#').replace(b'\x00',b' ').decode())
